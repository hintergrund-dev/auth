import { passwordMiddleware } from '../../../../src/password-auth';

export async function onRequest(context) {
	const { request, env } = context;
	if (passwordMiddleware(request, env.SECRET, '/login')) {
		return await context.next();
	} else {
		return new Response(null, {
			status: 302,
			statusText: 'Redirecting to login',
			headers: {
				location: `${redirect}?redirect=${request.url}`
			}
		});
	}
}
